

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Motion Sensor - PIR &mdash; trigBoard
Version 8 0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Temperature Logging to Grafana" href="temperatureSensor.html" />
    <link rel="prev" title="Garage Door Monitor" href="garage.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">trigBoard v8 Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="wheretobuy.html">Where To Buy</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="configurator.html">Configurator</a></li>
<li class="toctree-l1"><a class="reference internal" href="supportedServices.html">Supported Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hardware.html">Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="Firmware.html">Firmware/Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing/Factory Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>
<p class="caption"><span class="caption-text">Projects</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ePaperCoronaDisplay.html">E-Paper Corona Display</a></li>
<li class="toctree-l1"><a class="reference internal" href="cellularProject.html">Cellular/Battery Backed System</a></li>
<li class="toctree-l1"><a class="reference internal" href="doorbell.html">Door Bell Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="garage.html">Garage Door Monitor</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Motion Sensor - PIR</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#high-performance-option"><strong>High Performance Option</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#cheaper-option"><strong>Cheaper Option</strong></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#theory-of-operation"><strong>Theory of Operation</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="temperatureSensor.html">Temperature Logging to Grafana</a></li>
<li class="toctree-l1"><a class="reference internal" href="waterleakDetector.html">Water Leak Detector</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">trigBoard
Version 8</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Motion Sensor - PIR</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/motionSensor.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="motion-sensor-pir">
<h1>Motion Sensor - PIR<a class="headerlink" href="#motion-sensor-pir" title="Permalink to this headline">¶</a></h1>
<div class="section" id="high-performance-option">
<h2><strong>High Performance Option</strong><a class="headerlink" href="#high-performance-option" title="Permalink to this headline">¶</a></h2>
<img alt="_images/pirfrontview.JPG" class="align-center" src="_images/pirfrontview.JPG" />
<p>Looking for a simple PIR motion sensor? This is not cheap, but is very high performance and when you pair it up with the trigBoard, the average current is about ~3uA!!! That is insanely low for an always on PIR Motion sensor.  This is a genuine <a class="reference external" href="https://www.digikey.com/products/en?keywords=EKMB1201111">Panasonic EKMB1201111 sensor</a>,</p>
<img alt="_images/digikpirpana.png" class="align-center" src="_images/digikpirpana.png" />
<p>Believe it or not, but they do have lower power versions available, but for the cost, the 2uA version is good enough:</p>
<img alt="_images/panapirspecs.png" class="align-center" src="_images/panapirspecs.png" />
<p>Wiring is a piece of cake, just need to run an extra wire over to ground. Be careful with polarity - it does matter! Match it up with the markings on trigBoard + goes to VDD and - to OUT, the wire over to the ground pin.</p>
<img alt="_images/PIRPanawiring.png" class="align-center" src="_images/PIRPanawiring.png" />
<p>I was then able to poke holes through the 3D printed case to make everything fit in a nice compact solution:</p>
<img alt="_images/pirstickholes.JPG" class="align-center" src="_images/pirstickholes.JPG" />
<img alt="_images/pirwiring.JPG" class="align-center" src="_images/pirwiring.JPG" />
<img alt="_images/pirinstalledbattery.JPG" class="align-center" src="_images/pirinstalledbattery.JPG" />
<img alt="_images/PIRtopview.JPG" class="align-center" src="_images/PIRtopview.JPG" />
<p>Then no coding is needed! The base firmware will work out of the box here, so just set the message for when the contact closes to whatever you want and you’re good to go!</p>
</div>
<div class="section" id="cheaper-option">
<h2><strong>Cheaper Option</strong><a class="headerlink" href="#cheaper-option" title="Permalink to this headline">¶</a></h2>
<img alt="_images/PIRpic.png" class="align-center" src="_images/PIRpic.png" />
<p>This  option uses a cheaper PIR sensor that you can get from Amazon.  Note that it’s going to pull about 12uA, so that’s still  pretty good, just not as good as 2uA… Also note that this option requires some external circuitry and new code to be loaded.  This is because this PIR sensor output does not fully swing to the Vin.  The message that is used though is for the <strong>Wake Button</strong>.  This is because the sensor shares this same wake source.  Due to this, some special connections and code are needed.</p>
<p><a class="reference external" href="https://github.com/krdarrah/trigBoardV8_Motion">Motion Sensor Code is Here</a></p>
<p>The motion sensor is based on the AM312 and only pulls like 12uA - bought on <a class="reference external" href="https://www.amazon.com/gp/product/B07GJDJV63/ref=ppx_yo_dt_b_asin_title_o00__o00_s00?ie=UTF8&amp;psc=1">amazon</a></p>
<img alt="_images/pirAmazon.png" class="align-center" src="_images/pirAmazon.png" />
<p>You’ll also need a Schottky diode and 10k resistor.  The connection will need to be made directly to the same pad shared by the wake button:</p>
<img alt="_images/pirHookup.png" class="align-center" src="_images/pirHookup.png" />
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In the past I have ran into issues with these PIR sensors randomly triggering… so far with this setup after running for a long time along a stairwell getting triggered multiple times a day, I have had no issues.  <a class="reference external" href="https://www.youtube.com/watch?v=ONMOkGluXnk">Here is fix</a> if you do ever run into strange false triggers.</p>
</div>
<div class="section" id="theory-of-operation">
<h3><strong>Theory of Operation</strong><a class="headerlink" href="#theory-of-operation" title="Permalink to this headline">¶</a></h3>
<p>The PIR Sensor shares this trigger with the wake button input, which is totally fine and in fact, you could also add a normal contact to this is as well - then it becomes a door/window sensor and motion sensor! or even a water detector/motion sensor? That would be pretty cool!</p>
<p>Sharing this trigger is fine, but that means if we do use the wake button, the message is the same as the PIR trigger… no big deal.  The wake button pulls that pin HIGH to 4.2V, which is why we have that diode in there.  The PIR only drives up to ~1V or so.  That’s plenty to wake the board up, but without the diode you would damage the PIR anytime you pressed the wake button.  The code linked above is special because it monitors GPIO39 to see if it’s HIGH, then it knows this is a PIR wake, not from the button.  BUT, this is only 1V or so, so I actually have to analogRead this pin, and also just wait for it to go back low before going to sleep again:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="p">(</span><span class="n">analogRead</span><span class="p">(</span><span class="n">PIRpin</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//wait for PIR to settle</span>
  <span class="kt">int</span> <span class="n">PIRread</span> <span class="o">=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">PIRpin</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">PIRread</span><span class="p">);</span>
  <span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="temperatureSensor.html" class="btn btn-neutral float-right" title="Temperature Logging to Grafana" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="garage.html" class="btn btn-neutral float-left" title="Garage Door Monitor" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Kevin Darrah

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>